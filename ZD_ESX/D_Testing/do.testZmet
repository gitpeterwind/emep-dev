
deps=("ModelConstants" "SmallUtils" "CM_ChemDims" "CM_ChemSpecs" "TimeDate" \
      "CheckStops" "KeyValueTypes" "esx_Variables" "esx_Zgrid" \
      "LocalVariables" "Kz_ml")

tst="esx_Zmet"

rm zz.f90
for i in "${deps[@]}"
do
  echo "Adding $i"
  cat ../$i.f90 >> zz.f90
done

# Strip commented out test lines at end to get test-prog
sed "s/\!DSX//" ../$tst.f90 >> zz.f90

rm a.out
cp ../config_esx.nml .
gfortran -Wall -fbounds-check zz.f90
a.out
