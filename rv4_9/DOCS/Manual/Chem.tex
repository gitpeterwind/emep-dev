\chapter{Chemistry}

The relevant modules are:
\bigskip

\begin{tabular}{ll}
\hline
 & \\
\url{My_Chem_ml}    &  Defines indices, e.g. NADV, IXADV\_O3, O3 \\
                    &  mol. wts., rate coefficients etc. \\
                    & \\
\url{My_Reactions_ml}  &  Reactions, as different equations \\
 & \\
\hline
\end{tabular}


Can be changed by hand, but originally created by \url{GenChem}.
Should be re-instated!


\subsection*{My\_Chem\_ml}

e.g. definition of advected species (ADV):

\begin{verbatim}
  module  GenSpec_adv_ml
!-----------------------------------------------------------
  implicit none

!+ Defines indices and NSPEC for adv : Advected species

   integer, public, parameter ::  NSPEC_ADV = 58

 ! Aerosols:

   logical, public, parameter ::  ORG_AEROSOLS = .false.

   integer, public, parameter :: &
                NAEROSOL  = 0,         &!   Number of aerosol species
                FIRST_SOA = -99,       &!   First aerosol species
                LAST_SOA  = -99         !   Last  aerosol species

   integer, public, parameter ::   &
     IXADV_O3          =   1   &
  ,  IXADV_NO          =   2   &
  ,  IXADV_NO2         =   3   &
  ,  IXADV_PAN         =   4   &
  ,  IXADV_MPAN        =   5   &
  ,  IXADV_NO3         =   6   &

.....
\end{verbatim}

Similar list of indices for short-lived (SHL) species
such as OH of HO2, amd for extended list (OH, O3, NO, NO2 ...)

Also:
\begin{verbatim}
 contains
    subroutine define_chemicals()
    !+
    ! Assigns names, mol wts, carbon numbers, advec,  nmhc to user-defined Chemical
    ! array, using indices from total list of species (advected + short-lived).
    !
    !                                           MW NMHC  C    N   S
       species(  1) = Chemical("OD          ",  16,  0,  0,   0,  0 )
       species(  2) = Chemical("OP          ",  16,  0,  0,   0,  0 )
..
       species( 19) = Chemical("NO2         ",  46,  0,  0,   1,  0 )
       species( 39) = Chemical("NC4H10      ",  58,  1,  4,   0,  0 )
       species( 52) = Chemical("MVKO2H      ",   1,  0,  4,   0,  0 ) !ds1
.....
\end{verbatim}

\newpage
\subsection*{My\_Reactions\_ml}

Differential equations for all species, and solution
using Gauss-Seidel TWOSTEP:

\begin{verbatim}
!-> MVKO2

      P =   &
        rct(34,k) * xnew(MVK ) * xnew(OH )  &
      + 2.2e-11 * xnew(MVKO2H ) * xnew(OH )

      L =  &
        rct(13,k)* xnew(NO )  &
      + 1.0e-11* xnew(HO2 )

       xnew(MVKO2)=  amax1(0.0, ( xold(MVKO2) + dt2 * P))  &
                     /(1.0 + dt2*L )



!-> O3

      P =   &
        rcmisc(1,k) * xnew(OP )  &
      + rct(27,k) * xnew(CH3COO2 ) * xnew(HO2 )

      L =  &
       rct(1,k)* xnew(NO )  &
      + rct(2,k)* xnew(NO2 )  &
\end{verbatim}

